<!DOCTYPE html>
<html>
	<head>
		<title>GeeMail</title>
		<link rel="stylesheet" href="css/reset.css" />
		<link rel="stylesheet" href="css/style.css" media="screen">
		<script src="js/mail-generator.js"></script>
		<!-- <script src="js/app.js"></script> -->
		<script>
			// ALL OF YOUR JAVASCRIPT CODE SHOULD GO HERE. 
			// We have to use window.onload so your JavaScript doesn't execute until the page has loaded and all HTML has been downloaded to your browser
			window.onload = function() {
				console.log(window.geemails);
				let tbl = document.getElementById('tbl');
				let email = 0;

				window.geemails.forEach(function(msg) {
					loadEmail(msg)
				}); 

				function loadEmail(msg) {
					email++;
					// show number of messages
					document.getElementById('inbox').innerHTML = `Inbox ${email}`;
					
					// create row and cell for the email
					let rows = tbl.insertRow(1);
					let senderCell = rows.insertCell(0);
					senderCell.innerHTML = msg.sender;
					let subjectCell = rows.insertCell(1);
					subjectCell.innerHTML = msg.subject;
					let dateCell = rows.insertCell(2);
					dateCell.innerHTML = msg.date;
					let body = msg.body;

					// print info and message
					rows.onclick = function() {
						document.getElementById('email-info').innerHTML = `${msg.date}<br>${msg.sender}<br>${msg.subject}`;
						document.getElementById('email-content').innerHTML = `${body}`;
					}
				};
				// render new message
				setInterval(function() {
					loadEmail(getNewMessage());
				}, 8000)
			};
		</script>
	</head>

	<body>
		<header>
			<h1>GeeMail</h1>
			<input type="text" placeholder="Search..">
		</header>
		<div>
			<div class="nav">
				<ul>
					<li id="inbox"><a href="#">Inbox</a></li>
					<li><a href="#">Junk</a></li>
					<li><a href="#">Deleted</a></li>
					<li><a href="#">Sent</a></li>
				</ul> 
			</div>
			<div>
				<table id="tbl">
					<thead>
						<tr>
							<th>Subject</th>
							<th>Sender</th>
							<th>Date</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td></td>
						</tr>
					</tbody>
				</table>
			</div>
			<div>
				<div id="email-info"></div>
				<div id="email-content"></div>
			</div>
		</div>
	</body>
</html>